{"mappings":"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","sources":["app.js"],"sourcesContent":["\r\n// прямоугольник с заливкой\r\n// ctx.fillStyle = 'silver';\r\n// let x = 50;\r\n// ctx.fillRect(x, 50, 100, 100);\r\n\r\n// анимация через requesAnimationFrame\r\n// setInterval(function() {\r\n//     ctx.fillStyle = 'white';\r\n//     ctx.fillRect(0, 0, canv.width, canv.height);\r\n//     ctx.fillStyle = 'silver';\r\n//     ctx.fillRect(x++, 50, 100, 100);\r\n// }, 10);\r\n\r\n\r\n// прямоугольник линия\r\n// ctx.strokeStyle = 'grey';\r\n// ctx.lineWidth = 1;\r\n// ctx.strokeRect(200, 200, 250, 250);\r\n\r\n// круг\r\n// x, y, r, базовый угл, сектор, по часовой\r\n// ctx.arc(300, 300, 50, 0, Math.PI * 2, false);\r\n// ctx.fill();\r\n\r\n// масштабирование\r\n// ctx.scale(2, 2);\r\n\r\n// вращение градусы\r\n// ctx.rotate(10 * Math.PI/180);\r\n\r\n// фигура треугольник\r\n// ctx.strokeStyle = 'grey';\r\n// ctx.lineWidth = 5;\r\n\r\n// ctx.beginPath();\r\n// ctx.moveTo(50, 50);\r\n// ctx.lineTo(25, 100);\r\n// ctx.lineTo(75, 100);\r\n// ctx.closePath();\r\n// ctx.stroke();\r\n\r\n\r\n// текст\r\n// ctx.fillStyle = 'silver';\r\n// ctx.font = '20px Georgia';\r\n// ctx.fillText(\"Hello\", 50, 50);\r\n\r\n\r\n// градиент\r\n// let grad = ctx.addLinearGradient(0, 0, 500, 0);\r\n// grad.addColorStop('0', 'magenta');\r\n// grad.addColorStop('.50', 'blue');\r\n// grad.addColorStop('1', 'red');\r\n// ctx.fillStyle = grad;\r\n\r\n// let isMouseDown = false;\r\n\r\n// canv.addEventListener('mousedown', () => isMouseDown = true);\r\n// canv.addEventListener('mouseup', () => {\r\n//     isMouseDown = false;\r\n//     ctx.beginPath();\r\n// });\r\n\r\n// canv.addEventListener('mousemove', (e) => {\r\n\r\n//     if(isMouseDown) {\r\n\r\n//         ctx.lineWidth = 3 * 2;\r\n//         ctx.lineTo(e.clientX, e.clientY);\r\n//         ctx.stroke();\r\n\r\n//         ctx.beginPath();\r\n//         ctx.arc(e.clientX, e.clientY, 3, 0, Math.PI*2);\r\n//         ctx.fill();\r\n\r\n//         ctx.beginPath();\r\n//         ctx.moveTo(e.clientX, e.clientY);\r\n//     }\r\n    \r\n// });\r\n\r\n// // сохранение\r\n// document.addEventListener('keydown', (e) => {\r\n//     if(e.keyCode == 83) {\r\n//         // save S\r\n//     }\r\n//     if(e.keyCpde == 82) {\r\n//         // replay R\r\n//     }\r\n//     if(e.keyCode == 67) clear();\r\n// });\r\n\r\n// function clear() {\r\n//     ctx.fillStyle = 'white';\r\n//     ctx.fillRect(0, 0, canv.width, canv.height);\r\n\r\n//     ctx.beginPath();\r\n//     ctx.fillStyle = 'black';\r\n// }\r\n\r\n// картинка-подложка\r\n// let img = new Image();\r\n// const imageUrl = new URL(\r\n//     '1.png',\r\n//     import.meta.url\r\n// );\r\n// img.src = imageUrl;\r\n// img.onload = function() {\r\n//     // область вырезания из исходника, область вставки в канву\r\n//     ctx.drawImage(img, 0, 0, img.width, img.height, 0, 0, img.width, img.height);\r\n// }\r\n\r\nclass CanvasManager {\r\n\r\n    constructor() {\r\n\r\n        this.canv = document.getElementById('canvas');\r\n        this.ctx = this.canv.getContext('2d');\r\n\r\n        $(window).on(\"resize\", () => this.resize());\r\n\r\n        this.mouseX = 0;\r\n        this.mouseY = 0;\r\n        this.scrollX = 0;\r\n        this.scrollY = 0;\r\n        this.isLeftMouseDown = false;\r\n        this.isMiddleMouseDown = false;\r\n        this.mod = \"move\";\r\n        this.scale = 1;\r\n        this.ctrlKey = false;\r\n\r\n        this.stack = [];\r\n\r\n        this.resize();\r\n        this.init();\r\n\r\n    }\r\n    \r\n\r\n    resize() {\r\n\r\n        // сколько пикселей в 1мм\r\n        this.mmToPx = $(\".mm\").height();\r\n\r\n        // 297×420 мм\r\n        this.a3 = {\r\n            width: this.mmToPx * 420,\r\n            height: this.mmToPx * 297,\r\n        };\r\n\r\n        this.docWidth = this.a3.width;\r\n        this.docHeight = this.a3.height;\r\n\r\n        this.canv.width = $(\".area\").width();\r\n        this.canv.height = $(\".area\").height();\r\n\r\n    }\r\n\r\n\r\n    init() {\r\n\r\n        $(this.canv).on('mousemove', (e) => {\r\n            this.mouseX = e.offsetX;\r\n            this.mouseY = e.offsetY;\r\n        });\r\n\r\n        $(this.canv).on('mousedown', (e) => {\r\n            if(e.which == 1) this.isLeftMouseDown = true;\r\n            if(e.which == 2) this.isMiddleMouseDown = true;\r\n        });\r\n\r\n        $(this.canv).on('mouseup', (e) => {\r\n            if(e.which == 1) this.isLeftMouseDown = false;\r\n            if(e.which == 2) this.isMiddleMouseDown = false;\r\n        });\r\n\r\n        $(\"#add\").on(\"click\",  () => this.mod = \"add\");\r\n        $(\"#move\").on(\"click\",  () => this.mod = \"move\");\r\n\r\n        $(this.canv).on(\"click\", (e) => {\r\n            let rect = new Rect(this);\r\n            this.stack.push(rect);\r\n        });\r\n\r\n        $(this.canv).on(\"mousewheel\", (e) => {\r\n            e.preventDefault();\r\n            this.mousewheel(e);\r\n        });\r\n\r\n        this.ctx.strokeStyle = 'grey';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(this.scrollX, this.scrollY, 250, 250);\r\n\r\n    }\r\n\r\n\r\n    mousewheel(e) {\r\n\r\n        let dy = e.originalEvent.wheelDeltaY;\r\n        let aw = $(\".area\").width();\r\n        let ah = $(\".area\").height();\r\n\r\n\r\n        // если уперлись в границы документа, то не даем скроллать\r\n        if(e.ctrlKey) {\r\n\r\n            // документ поместился на экране без прокрутки\r\n            if(this.docWidth <= aw) return;\r\n\r\n            if(this.scrollX + dy >= this.docWidth) this.scrollX = this.docWidth - aw;\r\n            else if(this.scrollX + dy <= 0) this.scrollX = 0;\r\n            else this.scrollX += dy;\r\n        }\r\n        else {\r\n            // документ поместился на экране без прокрутки\r\n            if(this.docHeight <= aw) return;\r\n\r\n            if(this.scrollY + dy >= this.docHeight) this.scrollY = this.docWidth - ah;\r\n            else if(this.scrollY + dy <= 0) this.scrollY = 0;\r\n            else this.scrollX += dy;\r\n        }\r\n\r\n        this.paint();\r\n\r\n    }\r\n\r\n\r\n    paint() {\r\n\r\n        this.clear();\r\n\r\n        this.ctx.strokeStyle = 'grey';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(this.scrollX, this.scrollY, 250, 250);\r\n\r\n    };\r\n\r\n\r\n    clear() {\r\n\r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.fillRect(0, 0, this.canv.width, this.canv.height);\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'black';\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nclass Rect {\r\n    constructor(cm) {\r\n        this.cm = cm;\r\n        this.width = 200;\r\n        this.height = 100;\r\n    }\r\n\r\n}\r\n\r\nlet cm = new CanvasManager();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["$1ba56122d5b69567$var$Rect","constructor","cm","this","width","height","resize","mmToPx","$","a3","docWidth","docHeight","canv","init","on","e","mouseX","offsetX","mouseY","offsetY","which","isLeftMouseDown","isMiddleMouseDown","mod","rect","stack","push","preventDefault","mousewheel","ctx","strokeStyle","lineWidth","strokeRect","scrollX","scrollY","dy","originalEvent","wheelDeltaY","aw","ah","ctrlKey","paint","clear","fillStyle","fillRect","beginPath","document","getElementById","getContext","window","scale"],"version":3,"file":"index.253ead56.js.map"}