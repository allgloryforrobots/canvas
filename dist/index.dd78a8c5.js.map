{"mappings":"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","sources":["node_modules/@swc/helpers/src/_class_call_check.js","node_modules/@swc/helpers/src/_create_class.js","app.js"],"sourcesContent":["export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n","\r\n// прямоугольник с заливкой\r\n// ctx.fillStyle = 'silver';\r\n// let x = 50;\r\n// ctx.fillRect(x, 50, 100, 100);\r\n\r\n// анимация через requesAnimationFrame\r\n// setInterval(function() {\r\n//     ctx.fillStyle = 'white';\r\n//     ctx.fillRect(0, 0, canv.width, canv.height);\r\n//     ctx.fillStyle = 'silver';\r\n//     ctx.fillRect(x++, 50, 100, 100);\r\n// }, 10);\r\n\r\n\r\n// прямоугольник линия\r\n// ctx.strokeStyle = 'grey';\r\n// ctx.lineWidth = 1;\r\n// ctx.strokeRect(200, 200, 250, 250);\r\n\r\n// круг\r\n// x, y, r, базовый угл, сектор, по часовой\r\n// ctx.arc(300, 300, 50, 0, Math.PI * 2, false);\r\n// ctx.fill();\r\n\r\n// масштабирование\r\n// ctx.scale(2, 2);\r\n\r\n// вращение градусы\r\n// ctx.rotate(10 * Math.PI/180);\r\n\r\n// фигура треугольник\r\n// ctx.strokeStyle = 'grey';\r\n// ctx.lineWidth = 5;\r\n\r\n// ctx.beginPath();\r\n// ctx.moveTo(50, 50);\r\n// ctx.lineTo(25, 100);\r\n// ctx.lineTo(75, 100);\r\n// ctx.closePath();\r\n// ctx.stroke();\r\n\r\n\r\n// текст\r\n// ctx.fillStyle = 'silver';\r\n// ctx.font = '20px Georgia';\r\n// ctx.fillText(\"Hello\", 50, 50);\r\n\r\n\r\n// градиент\r\n// let grad = ctx.addLinearGradient(0, 0, 500, 0);\r\n// grad.addColorStop('0', 'magenta');\r\n// grad.addColorStop('.50', 'blue');\r\n// grad.addColorStop('1', 'red');\r\n// ctx.fillStyle = grad;\r\n\r\n// let isMouseDown = false;\r\n\r\n// canv.addEventListener('mousedown', () => isMouseDown = true);\r\n// canv.addEventListener('mouseup', () => {\r\n//     isMouseDown = false;\r\n//     ctx.beginPath();\r\n// });\r\n\r\n// canv.addEventListener('mousemove', (e) => {\r\n\r\n//     if(isMouseDown) {\r\n\r\n//         ctx.lineWidth = 3 * 2;\r\n//         ctx.lineTo(e.clientX, e.clientY);\r\n//         ctx.stroke();\r\n\r\n//         ctx.beginPath();\r\n//         ctx.arc(e.clientX, e.clientY, 3, 0, Math.PI*2);\r\n//         ctx.fill();\r\n\r\n//         ctx.beginPath();\r\n//         ctx.moveTo(e.clientX, e.clientY);\r\n//     }\r\n    \r\n// });\r\n\r\n// // сохранение\r\n// document.addEventListener('keydown', (e) => {\r\n//     if(e.keyCode == 83) {\r\n//         // save S\r\n//     }\r\n//     if(e.keyCpde == 82) {\r\n//         // replay R\r\n//     }\r\n//     if(e.keyCode == 67) clear();\r\n// });\r\n\r\n// function clear() {\r\n//     ctx.fillStyle = 'white';\r\n//     ctx.fillRect(0, 0, canv.width, canv.height);\r\n\r\n//     ctx.beginPath();\r\n//     ctx.fillStyle = 'black';\r\n// }\r\n\r\n// картинка-подложка\r\n// let img = new Image();\r\n// const imageUrl = new URL(\r\n//     '1.png',\r\n//     import.meta.url\r\n// );\r\n// img.src = imageUrl;\r\n// img.onload = function() {\r\n//     // область вырезания из исходника, область вставки в канву\r\n//     ctx.drawImage(img, 0, 0, img.width, img.height, 0, 0, img.width, img.height);\r\n// }\r\n\r\nclass CanvasManager {\r\n\r\n    constructor() {\r\n\r\n        this.canv = document.getElementById('canvas');\r\n        this.ctx = this.canv.getContext('2d');\r\n\r\n        $(window).on(\"resize\", () => this.resize());\r\n\r\n        this.mouseX = 0;\r\n        this.mouseY = 0;\r\n        this.scrollX = 0;\r\n        this.scrollY = 0;\r\n        this.isLeftMouseDown = false;\r\n        this.isMiddleMouseDown = false;\r\n        this.mod = \"move\";\r\n        this.scale = 1;\r\n        this.ctrlKey = false;\r\n\r\n        this.stack = [];\r\n\r\n        this.resize();\r\n        this.init();\r\n\r\n    }\r\n    \r\n\r\n    resize() {\r\n\r\n        // сколько пикселей в 1мм\r\n        this.mmToPx = $(\".mm\").height();\r\n\r\n        // 297×420 мм\r\n        this.a3 = {\r\n            width: this.mmToPx * 420,\r\n            height: this.mmToPx * 297,\r\n        };\r\n\r\n        this.docWidth = this.a3.width;\r\n        this.docHeight = this.a3.height;\r\n\r\n        this.canv.width = $(\".area\").width();\r\n        this.canv.height = $(\".area\").height();\r\n\r\n    }\r\n\r\n\r\n    init() {\r\n\r\n        $(this.canv).on('mousemove', (e) => {\r\n            this.mouseX = e.offsetX;\r\n            this.mouseY = e.offsetY;\r\n        });\r\n\r\n        $(this.canv).on('mousedown', (e) => {\r\n            if(e.which == 1) this.isLeftMouseDown = true;\r\n            if(e.which == 2) this.isMiddleMouseDown = true;\r\n        });\r\n\r\n        $(this.canv).on('mouseup', (e) => {\r\n            if(e.which == 1) this.isLeftMouseDown = false;\r\n            if(e.which == 2) this.isMiddleMouseDown = false;\r\n        });\r\n\r\n        $(\"#add\").on(\"click\",  () => this.mod = \"add\");\r\n        $(\"#move\").on(\"click\",  () => this.mod = \"move\");\r\n\r\n        $(this.canv).on(\"click\", (e) => {\r\n            let rect = new Rect(this);\r\n            this.stack.push(rect);\r\n        });\r\n\r\n        $(this.canv).on(\"mousewheel\", (e) => {\r\n            e.preventDefault();\r\n            this.mousewheel(e);\r\n        });\r\n\r\n        this.ctx.strokeStyle = 'grey';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(this.scrollX, this.scrollY, 250, 250);\r\n\r\n    }\r\n\r\n\r\n    mousewheel(e) {\r\n\r\n        let dy = e.originalEvent.wheelDeltaY;\r\n        let aw = $(\".area\").width();\r\n        let ah = $(\".area\").height();\r\n\r\n\r\n        // если уперлись в границы документа, то не даем скроллать\r\n        if(e.ctrlKey) {\r\n\r\n            // документ поместился на экране без прокрутки\r\n            if(this.docWidth <= aw) return;\r\n\r\n            if(this.scrollX + dy >= this.docWidth) this.scrollX = this.docWidth - aw;\r\n            else if(this.scrollX + dy <= 0) this.scrollX = 0;\r\n            else this.scrollX += dy;\r\n        }\r\n        else {\r\n            // документ поместился на экране без прокрутки\r\n            if(this.docHeight <= aw) return;\r\n\r\n            if(this.scrollY + dy >= this.docHeight) this.scrollY = this.docWidth - ah;\r\n            else if(this.scrollY + dy <= 0) this.scrollY = 0;\r\n            else this.scrollX += dy;\r\n        }\r\n\r\n        this.paint();\r\n\r\n    }\r\n\r\n\r\n    paint() {\r\n\r\n        this.clear();\r\n\r\n        this.ctx.strokeStyle = 'grey';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(this.scrollX, this.scrollY, 250, 250);\r\n\r\n    };\r\n\r\n\r\n    clear() {\r\n\r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.fillRect(0, 0, this.canv.width, this.canv.height);\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'black';\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nclass Rect {\r\n    constructor(cm) {\r\n        this.cm = cm;\r\n        this.width = 200;\r\n        this.height = 100;\r\n    }\r\n\r\n}\r\n\r\nlet cm = new CanvasManager();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["$b07b5082a7b10ea2$export$2e2bcd8739ae039","instance","Constructor","TypeError","$e5f9bd0c37e9914c$var$_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","$5c873b9df2ddf928$var$CanvasManager","this","canv","document","getElementById","ctx","getContext","$","window","on","_this","resize","mouseX","mouseY","scrollX","scrollY","isLeftMouseDown","isMiddleMouseDown","mod","scale","ctrlKey","stack","init","protoProps","staticProps","mmToPx","height","a3","width","docWidth","docHeight","e","offsetX","offsetY","which","rect","$5c873b9df2ddf928$var$Rect","push","preventDefault","mousewheel","strokeStyle","lineWidth","strokeRect","dy","originalEvent","wheelDeltaY","aw","ah","paint","clear","fillStyle","fillRect","beginPath","prototype","cm"],"version":3,"file":"index.dd78a8c5.js.map"}